<%= render "navbar" %>
  <div class="hcontainer" data-controller="graph">
    <div class="welcome-message">
      <% if user_signed_in? %>
        <h3>Hey <strong><%= current_user.email.split('@').first %></strong> !</h3>
        <h4>You've consumed <strong> <%= @visits.map(&:co2).compact.sum.round(2) %></strong> g of CO2 today</h4>
        <h4>But don't worry we'll break it down for you ...</h4>
      <% end %>

      <div data-graph-target="chart" data-green="<%= green_data(@visits) %>" ></div>
    </div>
    <div class="timeperiod">
      <div class="period">
       <div class="button_period">
        <%= link_to 'Day', request.params.merge(period: 'day'), data: { turbo: false } %>
       </div>
      </div>
      <div class="period">
        <div class="button_period">
         <%= link_to 'Week', request.params.merge(period: 'week'), data: { turbo: false } %>
        </div>
      </div>
      <div class="period">
        <div class="button_period">
          <%= link_to 'Month', request.params.merge(period: 'month'), data: { turbo: false } %>
        </div>
      </div>
    </div>

    <div class="consumption-info">
      <div class="carbon-intensity">
        <h4> Energy Intensity </h4>
        <p>Today your browsing consumed <%= @visits.map(&:energy).compact.sum.round(2) %> KW g.</p>
        <br>
        <p>Want to learn more about websites carbon footprint? </p>
        <a href="https://www.websitecarbon.com/how-does-it-work/" target="_blanck" class="learn-btn"><strong>Learn More</strong></a>
      </div>

      <div class="timeperiod-consumption">
        <div class="time-title">
          <h4>Today - <%= Time.now.strftime("%A %d of %B, %Y") %> </h4> <br>
        </div>

        <div class="consumption-breakdown">
          <div class="column-category">
            <h5> Website</h5><i class="fa-solid fa-caret-down"></i>
          </div>

          <div class="column-category">
            <h5> CO2 emissions</h5><i class="fa-solid fa-caret-down"></i>

          </div>
          <div class="column-category">
          <h5>Browsing duration</h5><i class="fa-solid fa-caret-down"></i>
          </div>
        </div>
      </div>
    </div>

    <h3> Your browsing represents: </h3> <br>
    <div class="consumption-imaged">
      <div id="lamp-lit">
        <i class="fa-regular fa-lightbulb fa-4x"></i>
        <h4>A light lit for 37 minutes</h4>
      </div>

      <div id="tv-watch">
        <i class="fa-solid fa-tv fa-4x"></i>
        <h4>Watching TV for 4.3 hours</h4>
      </div>

      <div id="train" >
        <i class="fa-solid fa-train fa-4x"></i></i>
        <h4>2.1 kilometers traveled by train</h4>
      </div>
    </div>
  </div>
</div>
<%= render "footer" %>
